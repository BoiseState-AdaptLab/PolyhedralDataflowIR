\hypertarget{_c_g__utils_8cc}{}\doxysection{lib/chill/omega/code\+\_\+gen/src/\+C\+G\+\_\+utils.cc File Reference}
\label{_c_g__utils_8cc}\index{lib/chill/omega/code\_gen/src/CG\_utils.cc@{lib/chill/omega/code\_gen/src/CG\_utils.cc}}
{\ttfamily \#include $<$typeinfo$>$}\newline
{\ttfamily \#include $<$omega.\+h$>$}\newline
{\ttfamily \#include $<$code\+\_\+gen/\+C\+G.\+h$>$}\newline
{\ttfamily \#include $<$code\+\_\+gen/\+C\+G\+\_\+utils.\+h$>$}\newline
{\ttfamily \#include $<$code\+\_\+gen/codegen\+\_\+error.\+h$>$}\newline
{\ttfamily \#include $<$math.\+h$>$}\newline
{\ttfamily \#include $<$stack$>$}\newline
Include dependency graph for C\+G\+\_\+utils.\+cc\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_c_g__utils_8cc__incl}
\end{center}
\end{figure}
\doxysubsection*{Namespaces}
\begin{DoxyCompactItemize}
\item 
 \mbox{\hyperlink{namespaceomega}{omega}}
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
bool \mbox{\hyperlink{namespaceomega_af49fbe6c15eba8beea7b37d46cf20c51}{omega\+::bound\+\_\+must\+\_\+hit\+\_\+stride}} (\mbox{\hyperlink{gen-psqr_8c_a2c212835823e3c54a8ab6d95c652660e}{const}} G\+E\+Q\+\_\+\+Handle \&inequality, Variable\+\_\+\+ID v, \mbox{\hyperlink{gen-psqr_8c_a2c212835823e3c54a8ab6d95c652660e}{const}} E\+Q\+\_\+\+Handle \&stride\+\_\+eq, Variable\+\_\+\+ID wc, \mbox{\hyperlink{gen-psqr_8c_a2c212835823e3c54a8ab6d95c652660e}{const}} Relation \&bounds, \mbox{\hyperlink{gen-psqr_8c_a2c212835823e3c54a8ab6d95c652660e}{const}} Relation \&known)
\begin{DoxyCompactList}\small\item\em If the stride equality is guaranteed to hit bound in inequality. \end{DoxyCompactList}\item 
C\+G\+\_\+output\+Repr $\ast$ \mbox{\hyperlink{namespaceomega_a4088b4dfc3a37781ea49f0292669f118}{omega\+::output\+\_\+ident}} (C\+G\+\_\+output\+Builder $\ast$ocg, \mbox{\hyperlink{gen-psqr_8c_a2c212835823e3c54a8ab6d95c652660e}{const}} Relation \&\mbox{\hyperlink{oski__main_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}, Variable\+\_\+\+ID v, \mbox{\hyperlink{gen-psqr_8c_a2c212835823e3c54a8ab6d95c652660e}{const}} std\+::vector$<$ std\+::pair$<$ C\+G\+\_\+output\+Repr $\ast$, int $>$ $>$ \&assigned\+\_\+on\+\_\+the\+\_\+fly, \mbox{\hyperlink{gen-psqr_8c_a2c212835823e3c54a8ab6d95c652660e}{const}} \mbox{\hyperlink{isl__test_8c_a4fddcd71ca9c907aeab13b4225b34720}{std\+::map}}$<$ std\+::string, std\+::vector$<$ C\+G\+\_\+output\+Repr $\ast$ $>$ $>$ \&unin)
\begin{DoxyCompactList}\small\item\em output the reference to variable v Return the variable by its name, however if this variable need to be substituted, as in assigned\+\_\+on\+\_\+the\+\_\+fly, return the substitution. \end{DoxyCompactList}\item 
std\+::pair$<$ C\+G\+\_\+output\+Repr $\ast$, std\+::pair$<$ C\+G\+\_\+output\+Repr $\ast$, int $>$ $>$ \mbox{\hyperlink{namespaceomega_a49c51e6b93089d93f44c6013df8c1bae}{omega\+::output\+\_\+assignment}} (C\+G\+\_\+output\+Builder $\ast$ocg, \mbox{\hyperlink{gen-psqr_8c_a2c212835823e3c54a8ab6d95c652660e}{const}} Relation \&\mbox{\hyperlink{oski__main_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}, int level, \mbox{\hyperlink{gen-psqr_8c_a2c212835823e3c54a8ab6d95c652660e}{const}} Relation \&known, \mbox{\hyperlink{gen-psqr_8c_a2c212835823e3c54a8ab6d95c652660e}{const}} std\+::vector$<$ std\+::pair$<$ C\+G\+\_\+output\+Repr $\ast$, int $>$ $>$ \&assigned\+\_\+on\+\_\+the\+\_\+fly, \mbox{\hyperlink{gen-psqr_8c_a2c212835823e3c54a8ab6d95c652660e}{const}} \mbox{\hyperlink{isl__test_8c_a4fddcd71ca9c907aeab13b4225b34720}{std\+::map}}$<$ std\+::string, std\+::vector$<$ C\+G\+\_\+output\+Repr $\ast$ $>$ $>$ \&unin)
\begin{DoxyCompactList}\small\item\em output the assignment for loop variable at level It will print if condition when the assignment constains mod constraint. such that coefficient is not 1. \end{DoxyCompactList}\item 
C\+G\+\_\+output\+Repr $\ast$ \mbox{\hyperlink{namespaceomega_aef22ad3b718ee17c2823fc7484f51465}{omega\+::output\+\_\+substitution\+\_\+repr}} (C\+G\+\_\+output\+Builder $\ast$ocg, \mbox{\hyperlink{gen-psqr_8c_a2c212835823e3c54a8ab6d95c652660e}{const}} E\+Q\+\_\+\+Handle \&equality, Variable\+\_\+\+ID v, bool apply\+\_\+v\+\_\+coef, \mbox{\hyperlink{gen-psqr_8c_a2c212835823e3c54a8ab6d95c652660e}{const}} Relation \&\mbox{\hyperlink{oski__main_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}, \mbox{\hyperlink{gen-psqr_8c_a2c212835823e3c54a8ab6d95c652660e}{const}} std\+::vector$<$ std\+::pair$<$ C\+G\+\_\+output\+Repr $\ast$, int $>$ $>$ \&assigned\+\_\+on\+\_\+the\+\_\+fly, \mbox{\hyperlink{gen-psqr_8c_a2c212835823e3c54a8ab6d95c652660e}{const}} \mbox{\hyperlink{isl__test_8c_a4fddcd71ca9c907aeab13b4225b34720}{std\+::map}}$<$ std\+::string, std\+::vector$<$ C\+G\+\_\+output\+Repr $\ast$ $>$ $>$ \&unin)
\begin{DoxyCompactList}\small\item\em Create substituting value from equality constraint. \end{DoxyCompactList}\item 
std\+::vector$<$ C\+G\+\_\+output\+Repr $\ast$ $>$ \mbox{\hyperlink{namespaceomega_a5bab288b9101457e5d4788e3f21b450f}{omega\+::output\+\_\+substitutions}} (C\+G\+\_\+output\+Builder $\ast$ocg, \mbox{\hyperlink{gen-psqr_8c_a2c212835823e3c54a8ab6d95c652660e}{const}} Relation \&\mbox{\hyperlink{oski__main_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}, \mbox{\hyperlink{gen-psqr_8c_a2c212835823e3c54a8ab6d95c652660e}{const}} std\+::vector$<$ std\+::pair$<$ C\+G\+\_\+output\+Repr $\ast$, int $>$ $>$ \&assigned\+\_\+on\+\_\+the\+\_\+fly, \mbox{\hyperlink{gen-psqr_8c_a2c212835823e3c54a8ab6d95c652660e}{const}} \mbox{\hyperlink{isl__test_8c_a4fddcd71ca9c907aeab13b4225b34720}{std\+::map}}$<$ std\+::string, std\+::vector$<$ C\+G\+\_\+output\+Repr $\ast$ $>$ $>$ \&unin)
\begin{DoxyCompactList}\small\item\em Find all substitutions based on current mapping Find substitution for each output variable in R, this can handle integer division. \end{DoxyCompactList}\item 
std\+::pair$<$ E\+Q\+\_\+\+Handle, int $>$ \mbox{\hyperlink{namespaceomega_a3c1fdeb5d550bb19be1c5303adbdcc11}{omega\+::find\+\_\+simplest\+\_\+assignment}} (\mbox{\hyperlink{gen-psqr_8c_a2c212835823e3c54a8ab6d95c652660e}{const}} Relation \&\mbox{\hyperlink{oski__main_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}, Variable\+\_\+\+ID v, \mbox{\hyperlink{gen-psqr_8c_a2c212835823e3c54a8ab6d95c652660e}{const}} std\+::vector$<$ std\+::pair$<$ C\+G\+\_\+output\+Repr $\ast$, int $>$ $>$ \&assigned\+\_\+on\+\_\+the\+\_\+fly=std\+::vector$<$ std\+::pair$<$ C\+G\+\_\+output\+Repr $\ast$, int $>$ $>$(), bool $\ast$has\+\_\+global\+\_\+inspector=\mbox{\hyperlink{_profiler_8hpp_a070d2ce7b6bb7e5c05602aa8c308d0c4}{N\+U\+LL}})
\begin{DoxyCompactList}\small\item\em Find the simplest(cheapest by cost function) assignment of variable v This handles floor definition wildcards in equality, the second in returned pair is the cost. \end{DoxyCompactList}\item 
std\+::pair$<$ bool, G\+E\+Q\+\_\+\+Handle $>$ \mbox{\hyperlink{namespaceomega_a4509260293a936d8be794b75afa0abc1}{omega\+::find\+\_\+floor\+\_\+definition}} (\mbox{\hyperlink{gen-psqr_8c_a2c212835823e3c54a8ab6d95c652660e}{const}} Relation \&\mbox{\hyperlink{oski__main_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}, Variable\+\_\+\+ID v, \mbox{\hyperlink{gmp__compat_8h_a1e8c092646181d922b1412a0b41dcfde}{std\+::set}}$<$ Variable\+\_\+\+ID $>$ excluded\+\_\+floor\+\_\+vars=\mbox{\hyperlink{gmp__compat_8h_a1e8c092646181d922b1412a0b41dcfde}{std\+::set}}$<$ Variable\+\_\+\+ID $>$())
\item 
std\+::pair$<$ E\+Q\+\_\+\+Handle, Variable\+\_\+\+ID $>$ \mbox{\hyperlink{namespaceomega_a57f007391042c9913e066e18a2ea66ca}{omega\+::find\+\_\+simplest\+\_\+stride}} (\mbox{\hyperlink{gen-psqr_8c_a2c212835823e3c54a8ab6d95c652660e}{const}} Relation \&\mbox{\hyperlink{oski__main_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}, Variable\+\_\+\+ID v)
\begin{DoxyCompactList}\small\item\em find the stride involving the specified variable e.\+g. v = 2alpha + c The stride equality can have other wildcards as long as they are defined as floor variables. \end{DoxyCompactList}\item 
C\+G\+\_\+output\+Repr $\ast$ \mbox{\hyperlink{namespaceomega_a26232deedbf05d315587b501330d8d3b}{omega\+::output\+\_\+guard}} (C\+G\+\_\+output\+Builder $\ast$ocg, \mbox{\hyperlink{gen-psqr_8c_a2c212835823e3c54a8ab6d95c652660e}{const}} Relation \&\mbox{\hyperlink{oski__main_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}, \mbox{\hyperlink{gen-psqr_8c_a2c212835823e3c54a8ab6d95c652660e}{const}} std\+::vector$<$ std\+::pair$<$ C\+G\+\_\+output\+Repr $\ast$, int $>$ $>$ \&assigned\+\_\+on\+\_\+the\+\_\+fly, \mbox{\hyperlink{gen-psqr_8c_a2c212835823e3c54a8ab6d95c652660e}{const}} \mbox{\hyperlink{isl__test_8c_a4fddcd71ca9c907aeab13b4225b34720}{std\+::map}}$<$ std\+::string, std\+::vector$<$ C\+G\+\_\+output\+Repr $\ast$ $>$ $>$ \&unin)
\begin{DoxyCompactList}\small\item\em Output the guard condition Output the guard conditions as captured in R. \end{DoxyCompactList}\item 
C\+G\+\_\+output\+Repr $\ast$ \mbox{\hyperlink{namespaceomega_a166d64dcca82e71eeb2d1a9852b1cad7}{omega\+::output\+\_\+inequality\+\_\+repr}} (C\+G\+\_\+output\+Builder $\ast$ocg, \mbox{\hyperlink{gen-psqr_8c_a2c212835823e3c54a8ab6d95c652660e}{const}} G\+E\+Q\+\_\+\+Handle \&inequality, Variable\+\_\+\+ID v, \mbox{\hyperlink{gen-psqr_8c_a2c212835823e3c54a8ab6d95c652660e}{const}} Relation \&\mbox{\hyperlink{oski__main_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}, \mbox{\hyperlink{gen-psqr_8c_a2c212835823e3c54a8ab6d95c652660e}{const}} std\+::vector$<$ std\+::pair$<$ C\+G\+\_\+output\+Repr $\ast$, int $>$ $>$ \&assigned\+\_\+on\+\_\+the\+\_\+fly, \mbox{\hyperlink{gen-psqr_8c_a2c212835823e3c54a8ab6d95c652660e}{const}} \mbox{\hyperlink{isl__test_8c_a4fddcd71ca9c907aeab13b4225b34720}{std\+::map}}$<$ std\+::string, std\+::vector$<$ C\+G\+\_\+output\+Repr $\ast$ $>$ $>$ \&unin, \mbox{\hyperlink{gmp__compat_8h_a1e8c092646181d922b1412a0b41dcfde}{std\+::set}}$<$ Variable\+\_\+\+ID $>$ excluded\+\_\+floor\+\_\+vars=\mbox{\hyperlink{gmp__compat_8h_a1e8c092646181d922b1412a0b41dcfde}{std\+::set}}$<$ Variable\+\_\+\+ID $>$())
\begin{DoxyCompactList}\small\item\em Output the inequality constraints containing v The return is only one side of the inequality without v. \end{DoxyCompactList}\item 
C\+G\+\_\+output\+Repr $\ast$ \mbox{\hyperlink{namespaceomega_ae94f50698ef78c3b1bfc5b8e358c5169}{omega\+::output\+\_\+upper\+\_\+bound\+\_\+repr}} (C\+G\+\_\+output\+Builder $\ast$ocg, \mbox{\hyperlink{gen-psqr_8c_a2c212835823e3c54a8ab6d95c652660e}{const}} G\+E\+Q\+\_\+\+Handle \&inequality, Variable\+\_\+\+ID v, \mbox{\hyperlink{gen-psqr_8c_a2c212835823e3c54a8ab6d95c652660e}{const}} Relation \&\mbox{\hyperlink{oski__main_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}, \mbox{\hyperlink{gen-psqr_8c_a2c212835823e3c54a8ab6d95c652660e}{const}} std\+::vector$<$ std\+::pair$<$ C\+G\+\_\+output\+Repr $\ast$, int $>$ $>$ \&assigned\+\_\+on\+\_\+the\+\_\+fly, \mbox{\hyperlink{gen-psqr_8c_a2c212835823e3c54a8ab6d95c652660e}{const}} \mbox{\hyperlink{isl__test_8c_a4fddcd71ca9c907aeab13b4225b34720}{std\+::map}}$<$ std\+::string, std\+::vector$<$ C\+G\+\_\+output\+Repr $\ast$ $>$ $>$ \&unin)
\begin{DoxyCompactList}\small\item\em Wrapper to output\+\_\+inequality\+\_\+repr When returning N\+U\+LL, it will replace it with literal 0 in output. \end{DoxyCompactList}\item 
C\+G\+\_\+output\+Repr $\ast$ \mbox{\hyperlink{namespaceomega_abfcb20c9255365b083ba94bf10f66d5d}{omega\+::output\+\_\+lower\+\_\+bound\+\_\+repr}} (C\+G\+\_\+output\+Builder $\ast$ocg, \mbox{\hyperlink{gen-psqr_8c_a2c212835823e3c54a8ab6d95c652660e}{const}} G\+E\+Q\+\_\+\+Handle \&inequality, Variable\+\_\+\+ID v, \mbox{\hyperlink{gen-psqr_8c_a2c212835823e3c54a8ab6d95c652660e}{const}} E\+Q\+\_\+\+Handle \&stride\+\_\+eq, Variable\+\_\+\+ID wc, \mbox{\hyperlink{gen-psqr_8c_a2c212835823e3c54a8ab6d95c652660e}{const}} Relation \&\mbox{\hyperlink{oski__main_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}, \mbox{\hyperlink{gen-psqr_8c_a2c212835823e3c54a8ab6d95c652660e}{const}} Relation \&known, \mbox{\hyperlink{gen-psqr_8c_a2c212835823e3c54a8ab6d95c652660e}{const}} std\+::vector$<$ std\+::pair$<$ C\+G\+\_\+output\+Repr $\ast$, int $>$ $>$ \&assigned\+\_\+on\+\_\+the\+\_\+fly, \mbox{\hyperlink{gen-psqr_8c_a2c212835823e3c54a8ab6d95c652660e}{const}} \mbox{\hyperlink{isl__test_8c_a4fddcd71ca9c907aeab13b4225b34720}{std\+::map}}$<$ std\+::string, std\+::vector$<$ C\+G\+\_\+output\+Repr $\ast$ $>$ $>$ \&unin)
\begin{DoxyCompactList}\small\item\em output lower bound with respect to lattice(starting iteration) \end{DoxyCompactList}\item 
C\+G\+\_\+output\+Repr $\ast$ \mbox{\hyperlink{namespaceomega_a3c8799ea1e5805d7d534ab6e54826393}{omega\+::output\+\_\+loop}} (C\+G\+\_\+output\+Builder $\ast$ocg, \mbox{\hyperlink{gen-psqr_8c_a2c212835823e3c54a8ab6d95c652660e}{const}} Relation \&\mbox{\hyperlink{oski__main_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}, int level, \mbox{\hyperlink{gen-psqr_8c_a2c212835823e3c54a8ab6d95c652660e}{const}} Relation \&known, \mbox{\hyperlink{gen-psqr_8c_a2c212835823e3c54a8ab6d95c652660e}{const}} std\+::vector$<$ std\+::pair$<$ C\+G\+\_\+output\+Repr $\ast$, int $>$ $>$ \&assigned\+\_\+on\+\_\+the\+\_\+fly, \mbox{\hyperlink{gen-psqr_8c_a2c212835823e3c54a8ab6d95c652660e}{const}} \mbox{\hyperlink{isl__test_8c_a4fddcd71ca9c907aeab13b4225b34720}{std\+::map}}$<$ std\+::string, std\+::vector$<$ C\+G\+\_\+output\+Repr $\ast$ $>$ $>$ \&unin)
\begin{DoxyCompactList}\small\item\em output the loop control structure at level Finding stride using find\+\_\+simplest\+\_\+stride and calculating bound using G\+E\+Qs. Multiple same sided bound will generate min/max operation. \end{DoxyCompactList}\item 
Variable\+\_\+\+ID \mbox{\hyperlink{namespaceomega_a72e30465bdd33c932341fb10b689a39c}{omega\+::replicate\+\_\+floor\+\_\+definition}} (\mbox{\hyperlink{gen-psqr_8c_a2c212835823e3c54a8ab6d95c652660e}{const}} Relation \&\mbox{\hyperlink{oski__main_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}, \mbox{\hyperlink{gen-psqr_8c_a2c212835823e3c54a8ab6d95c652660e}{const}} Variable\+\_\+\+ID floor\+\_\+var, Relation \&r, F\+\_\+\+Exists $\ast$f\+\_\+exists, F\+\_\+\+And $\ast$f\+\_\+root, \mbox{\hyperlink{isl__test_8c_a4fddcd71ca9c907aeab13b4225b34720}{std\+::map}}$<$ Variable\+\_\+\+ID, Variable\+\_\+\+ID $>$ \&exists\+\_\+mapping)
\begin{DoxyCompactList}\small\item\em replicate the floor definition(possibly cascaded to new relation) parameter f\+\_\+root is inside f\+\_\+exists, not the other way around. return replicated variable in new relation, with all cascaded floor definitions using wildcards defined in the same way as in the original relation. \end{DoxyCompactList}\item 
Relation \mbox{\hyperlink{namespaceomega_a5a4af0ea2e4522753aeb79ff72ee24f6}{omega\+::pick\+\_\+one\+\_\+guard}} (\mbox{\hyperlink{gen-psqr_8c_a2c212835823e3c54a8ab6d95c652660e}{const}} Relation \&\mbox{\hyperlink{oski__main_8c_a5c71a5e59a53413cd6c270266d63b031}{R}}, int level=0)
\begin{DoxyCompactList}\small\item\em pick one guard condition from relation. It can involve multiple constraints when involving wildcards, as long as its complement is a single conjunct. \end{DoxyCompactList}\item 
std\+::string \mbox{\hyperlink{namespaceomega_ae18388b8b679785e2ee5da636411301a}{omega\+::print\+\_\+to\+\_\+iegen\+\_\+string}} (Relation \&\mbox{\hyperlink{oski__main_8c_a5c71a5e59a53413cd6c270266d63b031}{R}})
\item 
Relation \mbox{\hyperlink{namespaceomega_ad9db28ba4ec274ff3085c0b1b2917994}{omega\+::check\+And\+Restore\+If\+Projected\+By\+Global}} (\mbox{\hyperlink{gen-psqr_8c_a2c212835823e3c54a8ab6d95c652660e}{const}} Relation \&R1, \mbox{\hyperlink{gen-psqr_8c_a2c212835823e3c54a8ab6d95c652660e}{const}} Relation \&R2, Variable\+\_\+\+ID v)
\begin{DoxyCompactList}\small\item\em Check if a set/input var is projected out of a inequality by a global variable with arity $>$ 0. \end{DoxyCompactList}\end{DoxyCompactItemize}
