<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: src/util/linalg.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_b7878ad5ecbf2506f4125b9d34c97e45.html">util</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">linalg.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="linalg_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#ifndef _LINALG_H_</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#define _LINALG_H_</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160; </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;math.h&gt;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;gsl/gsl_blas.h&gt;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;gsl/gsl_linalg.h&gt;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160; </div>
<div class="line"><a name="l00009"></a><span class="lineno"><a class="line" href="linalg_8h.html#ac39d9cef6a5e030ba8d9e11121054268">    9</a></span>&#160;<span class="preprocessor">#define max(x,y) (((x)&gt;(y))?(x):(y))</span></div>
<div class="line"><a name="l00010"></a><span class="lineno"><a class="line" href="linalg_8h.html#a4b433f612869f8640c31ec67fe39932c">   10</a></span>&#160;<span class="preprocessor">#define sgn(a,b) ((b) &gt;= 0.0 ? fabs(a) : -fabs(a))</span></div>
<div class="line"><a name="l00011"></a><span class="lineno"><a class="line" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">   11</a></span>&#160;<span class="preprocessor">#define lin(i,j,M) ((i)*(M)+(j))</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160; </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//typedef char bool;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//#define false     0</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">//#define true      1</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;gsl_matrix* <a class="code" href="linalg_8h.html#a22dfe70250fc26a63604ac2dd89a228e">moore_penrose_pinv</a>(gsl_matrix *<a class="code" href="conjgrad__dia_8h.html#afaca147747baba296a390629014973c8">A</a>, <span class="keyword">const</span> <span class="keywordtype">double</span> rcond);</div>
<div class="line"><a name="l00028"></a><span class="lineno"><a class="line" href="linalg_8h.html#a22dfe70250fc26a63604ac2dd89a228e">   28</a></span>&#160;<span class="keyword">inline</span> gsl_matrix* <a class="code" href="linalg_8h.html#a22dfe70250fc26a63604ac2dd89a228e">moore_penrose_pinv</a>(gsl_matrix *<a class="code" href="conjgrad__dia_8h.html#afaca147747baba296a390629014973c8">A</a>, <span class="keyword">const</span> <span class="keywordtype">double</span> rcond) {</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    gsl_matrix *<a class="code" href="cp__als__3d__coo_8h.html#a91c2874585e2db61acaa001032b19acf">V</a>, *Sigma_pinv, *<a class="code" href="euler__step__3d__ff__tile__cu_8h.html#ae6a3815bef35dc314aff7ebee7708985">U</a>, *A_pinv;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    gsl_matrix *_tmp_mat = <a class="code" href="_matrix_i_o_8hpp.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    gsl_vector *_tmp_vec;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    gsl_vector *<a class="code" href="euler__step__3d__ff__tile__cu_8h.html#af7325b366c4aecba2c4331767c0c3fe7">u</a>;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="jacobi_8h.html#a1b1a273bc7c0756f5076011a306f4f13">x</a>, cutoff;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>, <a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a> = <a class="code" href="conjgrad__dia_8h.html#afaca147747baba296a390629014973c8">A</a>-&gt;size1;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a> = <a class="code" href="conjgrad__dia_8h.html#afaca147747baba296a390629014973c8">A</a>-&gt;size2;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">//    bool was_swapped = false;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">//    if (m &gt; n) {</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">//        /* libgsl SVD can only handle the case m &lt;= n - transpose matrix */</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">//        was_swapped = true;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">//        _tmp_mat = gsl_matrix_alloc(m, n);</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">//        gsl_matrix_transpose_memcpy(_tmp_mat, A);</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">//        A = _tmp_mat;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">//        i = m;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">//        m = n;</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">//        n = i;</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">//    }</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="comment">/* do SVD */</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <a class="code" href="cp__als__3d__coo_8h.html#a91c2874585e2db61acaa001032b19acf">V</a> = gsl_matrix_alloc(<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>, <a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <a class="code" href="euler__step__3d__ff__tile__cu_8h.html#af7325b366c4aecba2c4331767c0c3fe7">u</a> = gsl_vector_alloc(<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    _tmp_vec = gsl_vector_alloc(<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    gsl_linalg_SV_decomp(<a class="code" href="conjgrad__dia_8h.html#afaca147747baba296a390629014973c8">A</a>, <a class="code" href="cp__als__3d__coo_8h.html#a91c2874585e2db61acaa001032b19acf">V</a>, <a class="code" href="euler__step__3d__ff__tile__cu_8h.html#af7325b366c4aecba2c4331767c0c3fe7">u</a>, _tmp_vec);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    gsl_vector_free(_tmp_vec);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="comment">/* compute Σ⁻¹ */</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    Sigma_pinv = gsl_matrix_alloc(<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>, <a class="code" href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a>);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    gsl_matrix_set_zero(Sigma_pinv);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    cutoff = rcond * gsl_vector_max(<a class="code" href="euler__step__3d__ff__tile__cu_8h.html#af7325b366c4aecba2c4331767c0c3fe7">u</a>);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a> = 0; <a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a> &lt; <a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>; ++<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>) {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <span class="keywordflow">if</span> (gsl_vector_get(<a class="code" href="euler__step__3d__ff__tile__cu_8h.html#af7325b366c4aecba2c4331767c0c3fe7">u</a>, <a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>) &gt; cutoff) {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;            <a class="code" href="jacobi_8h.html#a1b1a273bc7c0756f5076011a306f4f13">x</a> = 1. / gsl_vector_get(<a class="code" href="euler__step__3d__ff__tile__cu_8h.html#af7325b366c4aecba2c4331767c0c3fe7">u</a>, <a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        }</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;            <a class="code" href="jacobi_8h.html#a1b1a273bc7c0756f5076011a306f4f13">x</a> = 0.;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        }</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        gsl_matrix_set(Sigma_pinv, <a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>, <a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>, <a class="code" href="jacobi_8h.html#a1b1a273bc7c0756f5076011a306f4f13">x</a>);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    }</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="comment">/* libgsl SVD yields &quot;thin&quot; SVD - pad to full matrix by adding zeros */</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <a class="code" href="euler__step__3d__ff__tile__cu_8h.html#ae6a3815bef35dc314aff7ebee7708985">U</a> = gsl_matrix_alloc(<a class="code" href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a>, <a class="code" href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a>);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    gsl_matrix_set_zero(<a class="code" href="euler__step__3d__ff__tile__cu_8h.html#ae6a3815bef35dc314aff7ebee7708985">U</a>);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a> = 0; <a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a> &lt; <a class="code" href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a>; ++<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>) {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a> = 0; <a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a> &lt; <a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>; ++<a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>) {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;            gsl_matrix_set(<a class="code" href="euler__step__3d__ff__tile__cu_8h.html#ae6a3815bef35dc314aff7ebee7708985">U</a>, <a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>, <a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>, gsl_matrix_get(<a class="code" href="conjgrad__dia_8h.html#afaca147747baba296a390629014973c8">A</a>, <a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>, <a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>));</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        }</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    }</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">//    if (_tmp_mat != NULL) {</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">//        gsl_matrix_free(_tmp_mat);</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">//    }</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="comment">/* two dot products to obtain pseudoinverse */</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    _tmp_mat = gsl_matrix_alloc(<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>, <a class="code" href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a>);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    gsl_blas_dgemm(CblasNoTrans, CblasNoTrans, 1., <a class="code" href="cp__als__3d__coo_8h.html#a91c2874585e2db61acaa001032b19acf">V</a>, Sigma_pinv, 0., _tmp_mat);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">//    if (was_swapped) {</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">//        A_pinv = gsl_matrix_alloc(n, m);</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">//        gsl_blas_dgemm(CblasNoTrans, CblasTrans, 1., U, _tmp_mat, 0., A_pinv);</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">//    }</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">//    else {</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        A_pinv = gsl_matrix_alloc(<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>, <a class="code" href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a>);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        gsl_blas_dgemm(CblasNoTrans, CblasTrans, 1., _tmp_mat, <a class="code" href="euler__step__3d__ff__tile__cu_8h.html#ae6a3815bef35dc314aff7ebee7708985">U</a>, 0., A_pinv);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">//    }</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    gsl_matrix_free(_tmp_mat);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    gsl_matrix_free(<a class="code" href="euler__step__3d__ff__tile__cu_8h.html#ae6a3815bef35dc314aff7ebee7708985">U</a>);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    gsl_matrix_free(Sigma_pinv);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    gsl_vector_free(<a class="code" href="euler__step__3d__ff__tile__cu_8h.html#af7325b366c4aecba2c4331767c0c3fe7">u</a>);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    gsl_matrix_free(<a class="code" href="cp__als__3d__coo_8h.html#a91c2874585e2db61acaa001032b19acf">V</a>);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordflow">return</span> A_pinv;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;}</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">//float* mp_pinv_gsl(const float* a, float* a_inv, int N);</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">//inline float* mp_pinv_gsl(const float* a, float* a_inv, int N) {</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="keywordtype">float</span>* <a class="code" href="linalg_8h.html#ad9f47c2f8a96ff6b85827372bb85b3f3">mp_pinv</a>(<span class="keyword">const</span> <span class="keywordtype">float</span>* <a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>, <span class="keywordtype">float</span>* a_inv, <span class="keywordtype">int</span> <a class="code" href="debug_8txt.html#a02aba353117f867e67b23634a26c485d">N</a>);</div>
<div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="linalg_8h.html#ad9f47c2f8a96ff6b85827372bb85b3f3">  111</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">float</span>* <a class="code" href="linalg_8h.html#ad9f47c2f8a96ff6b85827372bb85b3f3">mp_pinv</a>(<span class="keyword">const</span> <span class="keywordtype">float</span>* <a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>, <span class="keywordtype">float</span>* a_inv, <span class="keywordtype">int</span> <a class="code" href="debug_8txt.html#a02aba353117f867e67b23634a26c485d">N</a>) {</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    gsl_matrix* <a class="code" href="conjgrad__dia_8h.html#afaca147747baba296a390629014973c8">A</a> = gsl_matrix_alloc(<a class="code" href="debug_8txt.html#a02aba353117f867e67b23634a26c485d">N</a>, <a class="code" href="debug_8txt.html#a02aba353117f867e67b23634a26c485d">N</a>);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keywordtype">double</span>* ptr = gsl_matrix_ptr(<a class="code" href="conjgrad__dia_8h.html#afaca147747baba296a390629014973c8">A</a>, 0, 0);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="comment">//memcpy(ptr, a, N * N * sizeof(float));</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a> = 0; <a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a> &lt; <a class="code" href="debug_8txt.html#a02aba353117f867e67b23634a26c485d">N</a> * <a class="code" href="debug_8txt.html#a02aba353117f867e67b23634a26c485d">N</a>; <a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>++) {</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        ptr[<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>] = <a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>[<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>];</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    }</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    gsl_matrix* A_inv = <a class="code" href="linalg_8h.html#a22dfe70250fc26a63604ac2dd89a228e">moore_penrose_pinv</a>(<a class="code" href="conjgrad__dia_8h.html#afaca147747baba296a390629014973c8">A</a>, 1E-15);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    ptr = gsl_matrix_ptr(A_inv, 0, 0);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="comment">//memcpy(a_inv, ptr, N * N * sizeof(float));</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a> = 0; <a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a> &lt; <a class="code" href="debug_8txt.html#a02aba353117f867e67b23634a26c485d">N</a> * <a class="code" href="debug_8txt.html#a02aba353117f867e67b23634a26c485d">N</a>; <a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>++) {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        a_inv[<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>] = ptr[<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>];</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    }</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    gsl_matrix_free(<a class="code" href="conjgrad__dia_8h.html#afaca147747baba296a390629014973c8">A</a>);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    gsl_matrix_free(A_inv);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordflow">return</span> a_inv;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;}</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="keywordtype">float</span>* <a class="code" href="linalg_8h.html#adf56cb3cbb1fc80d038cbcdd3ecaddee">mp_pinv_div</a>(<span class="keyword">const</span> <span class="keywordtype">float</span>* <a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>, <span class="keywordtype">float</span>* a_inv, <span class="keywordtype">int</span> <a class="code" href="debug_8txt.html#a02aba353117f867e67b23634a26c485d">N</a>);</div>
<div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="linalg_8h.html#adf56cb3cbb1fc80d038cbcdd3ecaddee">  133</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">float</span>* <a class="code" href="linalg_8h.html#adf56cb3cbb1fc80d038cbcdd3ecaddee">mp_pinv_div</a>(<span class="keyword">const</span> <span class="keywordtype">float</span>* <a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>, <span class="keywordtype">float</span>* a_inv, <span class="keywordtype">int</span> <a class="code" href="debug_8txt.html#a02aba353117f867e67b23634a26c485d">N</a>) {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a> = 0; <a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a> &lt; <a class="code" href="debug_8txt.html#a02aba353117f867e67b23634a26c485d">N</a> * <a class="code" href="debug_8txt.html#a02aba353117f867e67b23634a26c485d">N</a>; <a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>++) {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>[<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>] != 0.0) {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            a_inv[<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>] = 1.0 / <a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>[<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>];</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            fprintf(stderr,<span class="stringliteral">&quot;div by zero at i=%d!\n&quot;</span>, <a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        }</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    }</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;}</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="keyword">static</span> <span class="keywordtype">double</span> pythag(<span class="keywordtype">double</span> <a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>, <span class="keywordtype">double</span> <a class="code" href="gen-jacobitab_8c.html#a41cede1b4c0d05cff170ad5761f70964">b</a>) {</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keywordtype">double</span> at = fabs(<a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>), bt = fabs(<a class="code" href="gen-jacobitab_8c.html#a41cede1b4c0d05cff170ad5761f70964">b</a>), ct, result;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordflow">if</span> (at &gt; bt)       { ct = bt / at; result = at * <a class="code" href="namespacepdfg.html#a64a8f9db123ae96ec2cc5afdfe86ba33">sqrt</a>(1.0 + ct * ct); }</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bt &gt; 0.0) { ct = at / bt; result = bt * <a class="code" href="namespacepdfg.html#a64a8f9db123ae96ec2cc5afdfe86ba33">sqrt</a>(1.0 + ct * ct); }</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keywordflow">else</span> result = 0.0;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordflow">return</span>(result);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;}</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment"> * svdcomp - SVD decomposition routine.</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment"> * Takes an mxn matrix a and decomposes it into udv, where u,v are</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment"> * left and right orthogonal transformation matrices, and d is a</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment"> * diagonal matrix of singular values.</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment"> * This routine is adapted from svdecomp.c in XLISP-STAT 2.1 which is</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment"> * code from Numerical Recipes adapted by Luke Tierney and David Betz.</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment"> * Input to dsvd is as follows:</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment"> *   a = mxn matrix to be decomposed, gets overwritten with u</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment"> *   m = row dimension of a</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment"> *   n = column dimension of a</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment"> *   w = returns the vector of singular values of a</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment"> *   v = returns the right orthogonal transformation matrix</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="keywordtype">void</span> <a class="code" href="linalg_8h.html#a385f37753798c2d2df487604b8e02533">svdcomp</a>(<span class="keywordtype">float</span>* <a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>, <span class="keywordtype">int</span> <a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>, <span class="keywordtype">int</span> <a class="code" href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a>, <span class="keywordtype">float</span>* w, <span class="keywordtype">float</span>* v, <span class="keywordtype">float</span>* rv1);</div>
<div class="line"><a name="l00169"></a><span class="lineno"><a class="line" href="linalg_8h.html#a385f37753798c2d2df487604b8e02533">  169</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="linalg_8h.html#a385f37753798c2d2df487604b8e02533">svdcomp</a>(<span class="keywordtype">float</span>* <a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>, <span class="keywordtype">int</span> <a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>, <span class="keywordtype">int</span> <a class="code" href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a>, <span class="keywordtype">float</span>* w, <span class="keywordtype">float</span>* v, <span class="keywordtype">float</span>* rv1) {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordtype">int</span> flag, <a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>, its, <a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>, jj, <a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>, l, nm;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="taco__csr__err_8txt.html#acc395ff02b0516689a2d93451c959c0e">c</a>, <a class="code" href="gen-fib_8c.html#a2ff96143e367757f66180c3a774edd2b">f</a>, h, s, <a class="code" href="jacobi_8h.html#a1b1a273bc7c0756f5076011a306f4f13">x</a>, <a class="code" href="debug_8txt.html#a747fe083c247e80cbbb6dae440f8d19e">y</a>, <a class="code" href="minifluxdiv-notes_8txt.html#ace0ef0091b4a05bdf1a6c3abd06d600a">z</a>;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keywordtype">double</span> anorm = 0.0, g = 0.0, scale = 0.0;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="comment">/* Householder reduction to bidiagonal form */</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a> = 0; <a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a> &lt; <a class="code" href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a>; <a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>++) {</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="comment">/* left-hand reduction */</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        l = <a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a> + 1;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        rv1[<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>] = scale * g;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        g = s = scale = 0.0;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a> &lt; <a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>) {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a> = <a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>; <a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a> &lt; <a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>; <a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>++)</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                scale += fabs((<span class="keywordtype">double</span>)<a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>,<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)]);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            <span class="keywordflow">if</span> (scale) {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                <span class="keywordflow">for</span> (<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a> = <a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>; <a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a> &lt; <a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>; <a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>++) {</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                    <a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>,<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)] = (float)((<span class="keywordtype">double</span>)<a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>,<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)]/scale);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                    s += ((double)<a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>,<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)] * (double)<a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>,<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)]);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                <a class="code" href="gen-fib_8c.html#a2ff96143e367757f66180c3a774edd2b">f</a> = (double)<a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)];</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                g = -<a class="code" href="linalg_8h.html#a4b433f612869f8640c31ec67fe39932c">sgn</a>(<a class="code" href="namespacepdfg.html#a64a8f9db123ae96ec2cc5afdfe86ba33">sqrt</a>(s), <a class="code" href="gen-fib_8c.html#a2ff96143e367757f66180c3a774edd2b">f</a>);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                h = <a class="code" href="gen-fib_8c.html#a2ff96143e367757f66180c3a774edd2b">f</a> * g - s;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                <a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)] = (float)(<a class="code" href="gen-fib_8c.html#a2ff96143e367757f66180c3a774edd2b">f</a> - g);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a> != <a class="code" href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a> - 1) {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                    <span class="keywordflow">for</span> (<a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a> = l; <a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a> &lt; <a class="code" href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a>; <a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>++) {</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                        <span class="keywordflow">for</span> (s = 0.0, <a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a> = <a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>; <a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a> &lt; <a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>; <a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>++)</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                            s += ((<span class="keywordtype">double</span>)<a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>,<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)] * (double)<a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>,<a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)]);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                        <a class="code" href="gen-fib_8c.html#a2ff96143e367757f66180c3a774edd2b">f</a> = s / h;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                        <span class="keywordflow">for</span> (<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a> = <a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>; <a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a> &lt; <a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>; <a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>++)</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                            <a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>,<a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)] += (float)(<a class="code" href="gen-fib_8c.html#a2ff96143e367757f66180c3a774edd2b">f</a> * (<span class="keywordtype">double</span>)<a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>,<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)]);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                    }</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                }</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                <span class="keywordflow">for</span> (<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a> = <a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>; <a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a> &lt; <a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>; <a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>++)</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                    <a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>,<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)] = (float)((<span class="keywordtype">double</span>)<a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>,<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)]*scale);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            }</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        }</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        w[<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>] = (float)(scale * g);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        <span class="comment">/* right-hand reduction */</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        g = s = scale = 0.0;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a> &lt; <a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a> &amp;&amp; <a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a> != <a class="code" href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a> - 1) {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a> = l; <a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a> &lt; <a class="code" href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a>; <a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>++)</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                scale += fabs((<span class="keywordtype">double</span>)<a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)]);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            <span class="keywordflow">if</span> (scale) {</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                <span class="keywordflow">for</span> (<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a> = l; <a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a> &lt; <a class="code" href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a>; <a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>++) {</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                    <a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)] = (float)((<span class="keywordtype">double</span>)<a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)]/scale);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                    s += ((double)<a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)] * (double)<a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)]);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                }</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                <a class="code" href="gen-fib_8c.html#a2ff96143e367757f66180c3a774edd2b">f</a> = (double)<a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,l,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)];</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                g = -<a class="code" href="linalg_8h.html#a4b433f612869f8640c31ec67fe39932c">sgn</a>(<a class="code" href="namespacepdfg.html#a64a8f9db123ae96ec2cc5afdfe86ba33">sqrt</a>(s), <a class="code" href="gen-fib_8c.html#a2ff96143e367757f66180c3a774edd2b">f</a>);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                h = <a class="code" href="gen-fib_8c.html#a2ff96143e367757f66180c3a774edd2b">f</a> * g - s;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                <a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,l,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)] = (float)(<a class="code" href="gen-fib_8c.html#a2ff96143e367757f66180c3a774edd2b">f</a> - g);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                <span class="keywordflow">for</span> (<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a> = l; <a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a> &lt; <a class="code" href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a>; <a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>++)</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                    rv1[<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>] = (<span class="keywordtype">double</span>)<a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)] / h;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a> != <a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a> - 1) {</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                    <span class="keywordflow">for</span> (<a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a> = l; <a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a> &lt; <a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>; <a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>++) {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                        <span class="keywordflow">for</span> (s = 0.0, <a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a> = l; <a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a> &lt; <a class="code" href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a>; <a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>++)</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                            s += ((<span class="keywordtype">double</span>)<a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>,<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)] * (<span class="keywordtype">double</span>)<a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)]);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                        <span class="keywordflow">for</span> (<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a> = l; <a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a> &lt; <a class="code" href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a>; <a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>++)</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                            <a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>,<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)] += (float)(s * rv1[<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>]);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                    }</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                }</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                <span class="keywordflow">for</span> (<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a> = l; <a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a> &lt; <a class="code" href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a>; <a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>++)</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                    <a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)] = (float)((<span class="keywordtype">double</span>)<a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)]*scale);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        }</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        anorm = <a class="code" href="linalg_8h.html#ac39d9cef6a5e030ba8d9e11121054268">max</a>(anorm, (fabs((<span class="keywordtype">double</span>)w[<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>]) + fabs(rv1[<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>])));</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    }</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="comment">/* accumulate the right-hand transformation */</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a> = <a class="code" href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a> - 1; <a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a> &gt;= 0; <a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>--) {</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a> &lt; <a class="code" href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a> - 1) {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            <span class="keywordflow">if</span> (g) {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                <span class="keywordflow">for</span> (<a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a> = l; <a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a> &lt; <a class="code" href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a>; <a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>++)</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                    v[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>,<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)] = (float)(((<span class="keywordtype">double</span>)<a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)] / (<span class="keywordtype">double</span>)<a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,l,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)]) / g);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                <span class="comment">/* double division to avoid underflow */</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                <span class="keywordflow">for</span> (<a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a> = l; <a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a> &lt; <a class="code" href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a>; <a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>++) {</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                    <span class="keywordflow">for</span> (s = 0.0, <a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a> = l; <a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a> &lt; <a class="code" href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a>; <a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>++)</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                        s += ((<span class="keywordtype">double</span>)<a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)] * (double)v[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>,<a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)]);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                    <span class="keywordflow">for</span> (<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a> = l; <a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a> &lt; <a class="code" href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a>; <a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>++)</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                        v[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>,<a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)] += (float)(s * (<span class="keywordtype">double</span>)v[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>,<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)]);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                }</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            }</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a> = l; <a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a> &lt; <a class="code" href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a>; <a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>++)</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                v[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)] = v[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>,<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)] = 0.0;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        }</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        v[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)] = 1.0;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        g = rv1[<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>];</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        l = <a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    }</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160; </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="comment">/* accumulate the left-hand transformation */</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a> = <a class="code" href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a> - 1; <a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a> &gt;= 0; <a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>--) {</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        l = <a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a> + 1;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        g = (double) w[<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>];</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a> &lt; <a class="code" href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a> - 1)</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a> = l; <a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a> &lt; <a class="code" href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a>; <a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>++)</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                <a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)] = 0.0;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        <span class="keywordflow">if</span> (g) {</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            g = 1.0 / g;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a> != <a class="code" href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a> - 1) {</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                <span class="keywordflow">for</span> (<a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a> = l; <a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a> &lt; <a class="code" href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a>; <a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>++) {</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                    <span class="keywordflow">for</span> (s = 0.0, <a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a> = l; <a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a> &lt; <a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>; <a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>++)</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                        s += ((<span class="keywordtype">double</span>)<a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>,<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)] * (double)<a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>,<a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)]);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                    <a class="code" href="gen-fib_8c.html#a2ff96143e367757f66180c3a774edd2b">f</a> = (s / (double)<a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)]) * g;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                    <span class="keywordflow">for</span> (<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a> = <a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>; <a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a> &lt; <a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>; <a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>++)</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                        <a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>,<a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)] += (float)(<a class="code" href="gen-fib_8c.html#a2ff96143e367757f66180c3a774edd2b">f</a> * (<span class="keywordtype">double</span>)<a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>,<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)]);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                }</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            }</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a> = <a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>; <a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a> &lt; <a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>; <a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>++)</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                <a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>,<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)] = (float)((<span class="keywordtype">double</span>)<a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>,<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)]*g);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a> = <a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>; <a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a> &lt; <a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>; <a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>++)</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                <a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>,<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)] = 0.0;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        }</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        <a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)] += 1.0f;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    }</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="comment">/* diagonalize the bidiagonal form */</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a> = <a class="code" href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a> - 1; <a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a> &gt;= 0; <a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>--) {                             <span class="comment">/* loop over singular values */</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        <span class="keywordflow">for</span> (its = 0; its &lt; 30; its++) {                       <span class="comment">/* loop over allowed iterations */</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;            flag = 1;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            <span class="keywordflow">for</span> (l = <a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>; l &gt;= 0; l--) {                        <span class="comment">/* test for splitting */</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                nm = l - 1;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                <span class="keywordflow">if</span> (fabs(rv1[l]) + anorm == anorm) {</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                    flag = 0;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                }</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                <span class="keywordflow">if</span> (fabs((<span class="keywordtype">double</span>)w[nm]) + anorm == anorm)</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            }</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            <span class="keywordflow">if</span> (flag) {</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                <a class="code" href="taco__csr__err_8txt.html#acc395ff02b0516689a2d93451c959c0e">c</a> = 0.0;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                s = 1.0;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                <span class="keywordflow">for</span> (<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a> = l; <a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a> &lt;= <a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>; <a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>++) {</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                    <a class="code" href="gen-fib_8c.html#a2ff96143e367757f66180c3a774edd2b">f</a> = s * rv1[<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>];</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                    <span class="keywordflow">if</span> (fabs(<a class="code" href="gen-fib_8c.html#a2ff96143e367757f66180c3a774edd2b">f</a>) + anorm != anorm) {</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                        g = (double)w[<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>];</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                        h = pythag(<a class="code" href="gen-fib_8c.html#a2ff96143e367757f66180c3a774edd2b">f</a>, g);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                        w[<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>] = (float)h;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                        h = 1.0 / h;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                        <a class="code" href="taco__csr__err_8txt.html#acc395ff02b0516689a2d93451c959c0e">c</a> = g * h;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                        s = (- <a class="code" href="gen-fib_8c.html#a2ff96143e367757f66180c3a774edd2b">f</a> * h);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                        <span class="keywordflow">for</span> (<a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a> = 0; <a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a> &lt; <a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>; <a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>++) {</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                            <a class="code" href="debug_8txt.html#a747fe083c247e80cbbb6dae440f8d19e">y</a> = (double)<a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>,nm,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)];</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                            <a class="code" href="minifluxdiv-notes_8txt.html#ace0ef0091b4a05bdf1a6c3abd06d600a">z</a> = (double)<a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>,<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)];</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                            <a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>,nm,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)] = (float)(<a class="code" href="debug_8txt.html#a747fe083c247e80cbbb6dae440f8d19e">y</a> * <a class="code" href="taco__csr__err_8txt.html#acc395ff02b0516689a2d93451c959c0e">c</a> + <a class="code" href="minifluxdiv-notes_8txt.html#ace0ef0091b4a05bdf1a6c3abd06d600a">z</a> * s);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                            <a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>,<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)] = (float)(<a class="code" href="minifluxdiv-notes_8txt.html#ace0ef0091b4a05bdf1a6c3abd06d600a">z</a> * <a class="code" href="taco__csr__err_8txt.html#acc395ff02b0516689a2d93451c959c0e">c</a> - <a class="code" href="debug_8txt.html#a747fe083c247e80cbbb6dae440f8d19e">y</a> * s);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                        }</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                    }</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                }</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            }</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160; </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;            <a class="code" href="minifluxdiv-notes_8txt.html#ace0ef0091b4a05bdf1a6c3abd06d600a">z</a> = (double)w[<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>];</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            <span class="keywordflow">if</span> (l == <a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>) {                  <span class="comment">/* convergence */</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="minifluxdiv-notes_8txt.html#ace0ef0091b4a05bdf1a6c3abd06d600a">z</a> &lt; 0.0) {             <span class="comment">/* make singular value nonnegative */</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                    w[<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>] = (float)(-<a class="code" href="minifluxdiv-notes_8txt.html#ace0ef0091b4a05bdf1a6c3abd06d600a">z</a>);</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                    <span class="keywordflow">for</span> (<a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a> = 0; <a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a> &lt; <a class="code" href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a>; <a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>++)</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                        v[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>,<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)] = -v[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>,<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)];</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                }</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            }</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160; </div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            <span class="comment">/* shift from bottom 2 x 2 minor */</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;            <a class="code" href="jacobi_8h.html#a1b1a273bc7c0756f5076011a306f4f13">x</a> = (double)w[l];</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;            nm = <a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a> - 1;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            <a class="code" href="debug_8txt.html#a747fe083c247e80cbbb6dae440f8d19e">y</a> = (double)w[nm];</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            g = rv1[nm];</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            h = rv1[<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>];</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            <a class="code" href="gen-fib_8c.html#a2ff96143e367757f66180c3a774edd2b">f</a> = ((<a class="code" href="debug_8txt.html#a747fe083c247e80cbbb6dae440f8d19e">y</a> - <a class="code" href="minifluxdiv-notes_8txt.html#ace0ef0091b4a05bdf1a6c3abd06d600a">z</a>) * (<a class="code" href="debug_8txt.html#a747fe083c247e80cbbb6dae440f8d19e">y</a> + <a class="code" href="minifluxdiv-notes_8txt.html#ace0ef0091b4a05bdf1a6c3abd06d600a">z</a>) + (g - h) * (g + h)) / (2.0 * h * <a class="code" href="debug_8txt.html#a747fe083c247e80cbbb6dae440f8d19e">y</a>);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            g = pythag(<a class="code" href="gen-fib_8c.html#a2ff96143e367757f66180c3a774edd2b">f</a>, 1.0);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            <a class="code" href="gen-fib_8c.html#a2ff96143e367757f66180c3a774edd2b">f</a> = ((<a class="code" href="jacobi_8h.html#a1b1a273bc7c0756f5076011a306f4f13">x</a> - <a class="code" href="minifluxdiv-notes_8txt.html#ace0ef0091b4a05bdf1a6c3abd06d600a">z</a>) * (<a class="code" href="jacobi_8h.html#a1b1a273bc7c0756f5076011a306f4f13">x</a> + <a class="code" href="minifluxdiv-notes_8txt.html#ace0ef0091b4a05bdf1a6c3abd06d600a">z</a>) + h * ((<a class="code" href="debug_8txt.html#a747fe083c247e80cbbb6dae440f8d19e">y</a> / (<a class="code" href="gen-fib_8c.html#a2ff96143e367757f66180c3a774edd2b">f</a> + <a class="code" href="linalg_8h.html#a4b433f612869f8640c31ec67fe39932c">sgn</a>(g, <a class="code" href="gen-fib_8c.html#a2ff96143e367757f66180c3a774edd2b">f</a>))) - h)) / <a class="code" href="jacobi_8h.html#a1b1a273bc7c0756f5076011a306f4f13">x</a>;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160; </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            <span class="comment">/* next QR transformation */</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            <a class="code" href="taco__csr__err_8txt.html#acc395ff02b0516689a2d93451c959c0e">c</a> = s = 1.0;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a> = l; <a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a> &lt;= nm; <a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>++) {</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                <a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a> = <a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a> + 1;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                g = rv1[<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>];</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                <a class="code" href="debug_8txt.html#a747fe083c247e80cbbb6dae440f8d19e">y</a> = (double)w[<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>];</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                h = s * g;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                g = <a class="code" href="taco__csr__err_8txt.html#acc395ff02b0516689a2d93451c959c0e">c</a> * g;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                <a class="code" href="minifluxdiv-notes_8txt.html#ace0ef0091b4a05bdf1a6c3abd06d600a">z</a> = pythag(<a class="code" href="gen-fib_8c.html#a2ff96143e367757f66180c3a774edd2b">f</a>,h);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                rv1[<a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>] = <a class="code" href="minifluxdiv-notes_8txt.html#ace0ef0091b4a05bdf1a6c3abd06d600a">z</a>;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                <a class="code" href="taco__csr__err_8txt.html#acc395ff02b0516689a2d93451c959c0e">c</a> = <a class="code" href="gen-fib_8c.html#a2ff96143e367757f66180c3a774edd2b">f</a> / <a class="code" href="minifluxdiv-notes_8txt.html#ace0ef0091b4a05bdf1a6c3abd06d600a">z</a>;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                s = h / <a class="code" href="minifluxdiv-notes_8txt.html#ace0ef0091b4a05bdf1a6c3abd06d600a">z</a>;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                <a class="code" href="gen-fib_8c.html#a2ff96143e367757f66180c3a774edd2b">f</a> = <a class="code" href="jacobi_8h.html#a1b1a273bc7c0756f5076011a306f4f13">x</a> * <a class="code" href="taco__csr__err_8txt.html#acc395ff02b0516689a2d93451c959c0e">c</a> + g * s;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                g = g * <a class="code" href="taco__csr__err_8txt.html#acc395ff02b0516689a2d93451c959c0e">c</a> - <a class="code" href="jacobi_8h.html#a1b1a273bc7c0756f5076011a306f4f13">x</a> * s;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                h = <a class="code" href="debug_8txt.html#a747fe083c247e80cbbb6dae440f8d19e">y</a> * s;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                <a class="code" href="debug_8txt.html#a747fe083c247e80cbbb6dae440f8d19e">y</a> = <a class="code" href="debug_8txt.html#a747fe083c247e80cbbb6dae440f8d19e">y</a> * <a class="code" href="taco__csr__err_8txt.html#acc395ff02b0516689a2d93451c959c0e">c</a>;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                <span class="keywordflow">for</span> (jj = 0; jj &lt; <a class="code" href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a>; jj++) {</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                    <a class="code" href="jacobi_8h.html#a1b1a273bc7c0756f5076011a306f4f13">x</a> = (double)v[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(jj,<a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)];</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                    <a class="code" href="minifluxdiv-notes_8txt.html#ace0ef0091b4a05bdf1a6c3abd06d600a">z</a> = (double)v[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(jj,<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)];</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                    v[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(jj,<a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)] = (float)(<a class="code" href="jacobi_8h.html#a1b1a273bc7c0756f5076011a306f4f13">x</a> * <a class="code" href="taco__csr__err_8txt.html#acc395ff02b0516689a2d93451c959c0e">c</a> + <a class="code" href="minifluxdiv-notes_8txt.html#ace0ef0091b4a05bdf1a6c3abd06d600a">z</a> * s);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                    v[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(jj,<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)] = (float)(<a class="code" href="minifluxdiv-notes_8txt.html#ace0ef0091b4a05bdf1a6c3abd06d600a">z</a> * <a class="code" href="taco__csr__err_8txt.html#acc395ff02b0516689a2d93451c959c0e">c</a> - <a class="code" href="jacobi_8h.html#a1b1a273bc7c0756f5076011a306f4f13">x</a> * s);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                }</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                <a class="code" href="minifluxdiv-notes_8txt.html#ace0ef0091b4a05bdf1a6c3abd06d600a">z</a> = pythag(<a class="code" href="gen-fib_8c.html#a2ff96143e367757f66180c3a774edd2b">f</a>, h);</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                w[<a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>] = (float)<a class="code" href="minifluxdiv-notes_8txt.html#ace0ef0091b4a05bdf1a6c3abd06d600a">z</a>;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="minifluxdiv-notes_8txt.html#ace0ef0091b4a05bdf1a6c3abd06d600a">z</a>) {</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                    <a class="code" href="minifluxdiv-notes_8txt.html#ace0ef0091b4a05bdf1a6c3abd06d600a">z</a> = 1.0 / <a class="code" href="minifluxdiv-notes_8txt.html#ace0ef0091b4a05bdf1a6c3abd06d600a">z</a>;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                    <a class="code" href="taco__csr__err_8txt.html#acc395ff02b0516689a2d93451c959c0e">c</a> = <a class="code" href="gen-fib_8c.html#a2ff96143e367757f66180c3a774edd2b">f</a> * <a class="code" href="minifluxdiv-notes_8txt.html#ace0ef0091b4a05bdf1a6c3abd06d600a">z</a>;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                    s = h * <a class="code" href="minifluxdiv-notes_8txt.html#ace0ef0091b4a05bdf1a6c3abd06d600a">z</a>;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                }</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                <a class="code" href="gen-fib_8c.html#a2ff96143e367757f66180c3a774edd2b">f</a> = (<a class="code" href="taco__csr__err_8txt.html#acc395ff02b0516689a2d93451c959c0e">c</a> * g) + (s * <a class="code" href="debug_8txt.html#a747fe083c247e80cbbb6dae440f8d19e">y</a>);</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                <a class="code" href="jacobi_8h.html#a1b1a273bc7c0756f5076011a306f4f13">x</a> = (<a class="code" href="taco__csr__err_8txt.html#acc395ff02b0516689a2d93451c959c0e">c</a> * <a class="code" href="debug_8txt.html#a747fe083c247e80cbbb6dae440f8d19e">y</a>) - (s * g);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                <span class="keywordflow">for</span> (jj = 0; jj &lt; <a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>; jj++) {</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                    <a class="code" href="debug_8txt.html#a747fe083c247e80cbbb6dae440f8d19e">y</a> = (double)<a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(jj,<a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)];</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                    <a class="code" href="minifluxdiv-notes_8txt.html#ace0ef0091b4a05bdf1a6c3abd06d600a">z</a> = (double)<a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(jj,<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)];</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                    <a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(jj,<a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)] = (float)(<a class="code" href="debug_8txt.html#a747fe083c247e80cbbb6dae440f8d19e">y</a> * <a class="code" href="taco__csr__err_8txt.html#acc395ff02b0516689a2d93451c959c0e">c</a> + <a class="code" href="minifluxdiv-notes_8txt.html#ace0ef0091b4a05bdf1a6c3abd06d600a">z</a> * s);</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                    <a class="code" href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a>[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(jj,<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)] = (float)(<a class="code" href="minifluxdiv-notes_8txt.html#ace0ef0091b4a05bdf1a6c3abd06d600a">z</a> * <a class="code" href="taco__csr__err_8txt.html#acc395ff02b0516689a2d93451c959c0e">c</a> - <a class="code" href="debug_8txt.html#a747fe083c247e80cbbb6dae440f8d19e">y</a> * s);</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                }</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;            }</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            rv1[l] = 0.0;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            rv1[<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>] = <a class="code" href="gen-fib_8c.html#a2ff96143e367757f66180c3a774edd2b">f</a>;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;            w[<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>] = (float)<a class="code" href="jacobi_8h.html#a1b1a273bc7c0756f5076011a306f4f13">x</a>;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        }</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    }</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;}</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="keywordtype">float</span>* <a class="code" href="linalg_8h.html#ab723a4c98b3e9afd5e3f33ba7219e9bf">mp_pinv_bad</a>(<span class="keywordtype">float</span>* <a class="code" href="conjgrad__dia_8h.html#afaca147747baba296a390629014973c8">A</a>, <span class="keywordtype">unsigned</span> <a class="code" href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a>);</div>
<div class="line"><a name="l00398"></a><span class="lineno"><a class="line" href="linalg_8h.html#a294f634dc6e21c63ef39af38db24f8ff">  398</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">float</span>* <a class="code" href="linalg_8h.html#ab723a4c98b3e9afd5e3f33ba7219e9bf">mp_pinv_bad</a>(<span class="keywordtype">float</span>* <a class="code" href="conjgrad__dia_8h.html#afaca147747baba296a390629014973c8">A</a>, <span class="keywordtype">float</span>* A_pinv, <span class="keywordtype">unsigned</span> <a class="code" href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a>) {</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="keywordtype">float</span> *<a class="code" href="cp__als__3d__coo_8h.html#a91c2874585e2db61acaa001032b19acf">V</a>, *Sigma_pinv, *<a class="code" href="euler__step__3d__ff__tile__cu_8h.html#ae6a3815bef35dc314aff7ebee7708985">U</a>; <span class="comment">//, *A_pinv;</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="keywordtype">float</span> *tmp = <a class="code" href="_matrix_i_o_8hpp.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="comment">//float *_tmp_vec;</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="keywordtype">float</span> *w;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="keywordtype">float</span> <a class="code" href="jacobi_8h.html#a1b1a273bc7c0756f5076011a306f4f13">x</a>, cutoff;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>, <a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>, <a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span> rcond = 1E-15;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a> = <a class="code" href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a>;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160; </div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <a class="code" href="cp__als__3d__coo_8h.html#a91c2874585e2db61acaa001032b19acf">V</a> = (<span class="keywordtype">float</span>*) <a class="code" href="parser_8tab_8cc.html#a5faf6a2d99f50a4655dd390199a8db7b">malloc</a>(<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a> * <a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a> * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));     <span class="comment">//gsl_matrix_alloc(m, m);</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    w = (<span class="keywordtype">float</span>*) <a class="code" href="parser_8tab_8cc.html#a5faf6a2d99f50a4655dd390199a8db7b">malloc</a>(<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a> * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));         <span class="comment">//gsl_vector_alloc(m);</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    tmp = (<span class="keywordtype">float</span>*) <a class="code" href="parser_8tab_8cc.html#a5faf6a2d99f50a4655dd390199a8db7b">malloc</a>(<a class="code" href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="comment">//_tmp_vec = (float*) malloc(m * sizeof(float));  //gsl_vector_alloc(m);</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="comment">//gsl_linalg_SV_decomp(A, V, w, _tmp_vec);</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <a class="code" href="linalg_8h.html#a385f37753798c2d2df487604b8e02533">svdcomp</a>(<a class="code" href="conjgrad__dia_8h.html#afaca147747baba296a390629014973c8">A</a>, <a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>, <a class="code" href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a>, w, <a class="code" href="cp__als__3d__coo_8h.html#a91c2874585e2db61acaa001032b19acf">V</a>, tmp);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <a class="code" href="parser_8tab_8cc.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a>(tmp);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="comment">//gsl_vector_free(_tmp_vec);</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160; </div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="comment">/* compute Σ⁻¹ */</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    Sigma_pinv = (<span class="keywordtype">float</span>*) calloc(<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a> * <a class="code" href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>)); <span class="comment">//gsl_matrix_alloc(m, n);</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="comment">//gsl_matrix_set_zero(Sigma_pinv);</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="keywordtype">float</span> wmax = w[0];</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a> = 1; <a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a> &lt; <a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>; <a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>++) {</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        <span class="keywordflow">if</span> (w[<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>] &gt; wmax) {</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;            wmax = w[<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>];</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        }</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    }</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    cutoff = rcond * wmax;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160; </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a> = 0; <a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a> &lt; <a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>; ++<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>) {</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <span class="keywordflow">if</span> (w[<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>] &gt; cutoff) {</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            Sigma_pinv[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)] = 1.0 / w[<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>];</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        }</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        <span class="comment">//gsl_matrix_set(Sigma_pinv, i, i, x);</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    }</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160; </div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="comment">/* libgsl SVD yields &quot;thin&quot; SVD - pad to full matrix by adding zeros */</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="comment">//U = gsl_matrix_alloc(n, n);</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="comment">//gsl_matrix_set_zero(U);</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <a class="code" href="euler__step__3d__ff__tile__cu_8h.html#ae6a3815bef35dc314aff7ebee7708985">U</a> = (<span class="keywordtype">float</span>*) calloc(<a class="code" href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a> * <a class="code" href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>)); <span class="comment">//gsl_matrix_alloc(m, n);</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160; </div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a> = 0; <a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a> &lt; <a class="code" href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a>; ++<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>) {</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a> = 0; <a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a> &lt; <a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>; ++<a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>) {</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;            <span class="comment">//gsl_matrix_set(U, i, j, gsl_matrix_get(A, i, j));</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;            <a class="code" href="euler__step__3d__ff__tile__cu_8h.html#ae6a3815bef35dc314aff7ebee7708985">U</a>[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>,<a class="code" href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a>)] = <a class="code" href="conjgrad__dia_8h.html#afaca147747baba296a390629014973c8">A</a>[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)];</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        }</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    }</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160; </div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="comment">/* two dot products to obtain pseudoinverse */</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    tmp = (<span class="keywordtype">float</span>*) calloc(<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a> * <a class="code" href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>)); <span class="comment">//gsl_matrix_alloc(m, n);</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="comment">//gsl_blas_dgemm(CblasNoTrans, CblasNoTrans, 1., V, Sigma_pinv, 0., tmp);</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a> = 0; <a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a> &lt; <a class="code" href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a>; <a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>++) {</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <span class="keywordflow">for</span>(<a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a> = 0; <a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a> &lt; <a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>; <a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>++) {</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;            <span class="keywordflow">for</span>(<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a> = 0; <a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a> &lt; <a class="code" href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a>; <a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>++) {</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                tmp[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>,<a class="code" href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a>)]+=<a class="code" href="cp__als__3d__coo_8h.html#a91c2874585e2db61acaa001032b19acf">V</a>[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)]*Sigma_pinv[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>,<a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>,<a class="code" href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a>)];</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;            }</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        }</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    }</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160; </div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="comment">//A_pinv = (float*) calloc(m * n, sizeof(float)); //gsl_matrix_alloc(m, n);</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="comment">//gsl_blas_dgemm(CblasNoTrans, CblasTrans, 1., tmp, U, 0., A_pinv);</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a> = 0; <a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a> &lt; <a class="code" href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a>; <a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>++) {</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        <span class="keywordflow">for</span>(<a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a> = 0; <a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a> &lt; <a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>; <a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>++) {</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;            <span class="keywordflow">for</span>(<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a> = 0; <a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a> &lt; <a class="code" href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a>; <a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>++) {</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                A_pinv[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>,<a class="code" href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a>)]+=tmp[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a>,<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>,<a class="code" href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a>)]*<a class="code" href="euler__step__3d__ff__tile__cu_8h.html#ae6a3815bef35dc314aff7ebee7708985">U</a>[<a class="code" href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a>(<a class="code" href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a>,<a class="code" href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a>,<a class="code" href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a>)];</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;            }</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        }</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    }</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160; </div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <a class="code" href="parser_8tab_8cc.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a>(<a class="code" href="euler__step__3d__ff__tile__cu_8h.html#ae6a3815bef35dc314aff7ebee7708985">U</a>);                            <span class="comment">//gsl_matrix_free(U);</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <a class="code" href="parser_8tab_8cc.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a>(Sigma_pinv);                   <span class="comment">//gsl_matrix_free(Sigma_pinv);</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <a class="code" href="parser_8tab_8cc.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a>(w);                            <span class="comment">//gsl_vector_free(w);</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <a class="code" href="parser_8tab_8cc.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a>(<a class="code" href="cp__als__3d__coo_8h.html#a91c2874585e2db61acaa001032b19acf">V</a>);                            <span class="comment">//gsl_matrix_free(V);</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <a class="code" href="parser_8tab_8cc.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a>(tmp);</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160; </div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="keywordflow">return</span> A_pinv;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;}</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160; </div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="preprocessor">#undef max</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="preprocessor">#undef lin</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="preprocessor">#undef sgn</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160; </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="preprocessor">#endif      // _LINALG_H_</span></div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aminifluxdiv-notes_8txt_html_ace0ef0091b4a05bdf1a6c3abd06d600a"><div class="ttname"><a href="minifluxdiv-notes_8txt.html#ace0ef0091b4a05bdf1a6c3abd06d600a">z</a></div><div class="ttdeci">Original Expected SC Experimental Results Switching everything to nixing the no other Chose micro and realize performance improvements in a few then punchline Automated shifting tool generated code that closely mathced those that were manually determined Describe the machine(R2). Did not match previous results(SC14 paper) because data accesses were not optimized. Subsection fuseWithinDirections Translated instructions see my DIFFY by DIFFZ z</div><div class="ttdef"><b>Definition:</b> minifluxdiv-notes.txt:193</div></div>
<div class="ttc" id="alinalg_8h_html_ac9009d9017f2d085013e2a511815ea96"><div class="ttname"><a href="linalg_8h.html#ac9009d9017f2d085013e2a511815ea96">lin</a></div><div class="ttdeci">#define lin(i, j, M)</div><div class="ttdef"><b>Definition:</b> linalg.h:11</div></div>
<div class="ttc" id="alinalg_8h_html_ab723a4c98b3e9afd5e3f33ba7219e9bf"><div class="ttname"><a href="linalg_8h.html#ab723a4c98b3e9afd5e3f33ba7219e9bf">mp_pinv_bad</a></div><div class="ttdeci">float * mp_pinv_bad(float *A, unsigned n)</div></div>
<div class="ttc" id="anamespacepdfg_html_a64a8f9db123ae96ec2cc5afdfe86ba33"><div class="ttname"><a href="namespacepdfg.html#a64a8f9db123ae96ec2cc5afdfe86ba33">pdfg::sqrt</a></div><div class="ttdeci">Math sqrt(const Expr &amp;expr)</div><div class="ttdef"><b>Definition:</b> GraphIL.hpp:393</div></div>
<div class="ttc" id="agen-jacobitab_8c_html_a24420a9beaac7cee08b5e255a4c29db1"><div class="ttname"><a href="gen-jacobitab_8c.html#a24420a9beaac7cee08b5e255a4c29db1">a</a></div><div class="ttdeci">unsigned char a</div><div class="ttdef"><b>Definition:</b> gen-jacobitab.c:42</div></div>
<div class="ttc" id="adebug_8txt_html_a2270dd79b87b2f6d27cf95b278fd482c"><div class="ttname"><a href="debug_8txt.html#a2270dd79b87b2f6d27cf95b278fd482c">j</a></div><div class="ttdeci">gemm j</div><div class="ttdef"><b>Definition:</b> debug.txt:3</div></div>
<div class="ttc" id="adebug_8txt_html_acc5234e9b8d83af1f88e9e91b3c5ff27"><div class="ttname"><a href="debug_8txt.html#acc5234e9b8d83af1f88e9e91b3c5ff27">k</a></div><div class="ttdeci">gemm k</div><div class="ttdef"><b>Definition:</b> debug.txt:3</div></div>
<div class="ttc" id="agen-jacobitab_8c_html_a41cede1b4c0d05cff170ad5761f70964"><div class="ttname"><a href="gen-jacobitab_8c.html#a41cede1b4c0d05cff170ad5761f70964">b</a></div><div class="ttdeci">unsigned char b</div><div class="ttdef"><b>Definition:</b> gen-jacobitab.c:43</div></div>
<div class="ttc" id="alinalg_8h_html_a4b433f612869f8640c31ec67fe39932c"><div class="ttname"><a href="linalg_8h.html#a4b433f612869f8640c31ec67fe39932c">sgn</a></div><div class="ttdeci">#define sgn(a, b)</div><div class="ttdef"><b>Definition:</b> linalg.h:10</div></div>
<div class="ttc" id="aparser_8tab_8cc_html_a5faf6a2d99f50a4655dd390199a8db7b"><div class="ttname"><a href="parser_8tab_8cc.html#a5faf6a2d99f50a4655dd390199a8db7b">malloc</a></div><div class="ttdeci">void * malloc(YYSIZE_T)</div></div>
<div class="ttc" id="alinalg_8h_html_adf56cb3cbb1fc80d038cbcdd3ecaddee"><div class="ttname"><a href="linalg_8h.html#adf56cb3cbb1fc80d038cbcdd3ecaddee">mp_pinv_div</a></div><div class="ttdeci">float * mp_pinv_div(const float *a, float *a_inv, int N)</div><div class="ttdef"><b>Definition:</b> linalg.h:133</div></div>
<div class="ttc" id="ajacobi_8h_html_a1b1a273bc7c0756f5076011a306f4f13"><div class="ttname"><a href="jacobi_8h.html#a1b1a273bc7c0756f5076011a306f4f13">x</a></div><div class="ttdeci">#define x(t, i)</div><div class="ttdef"><b>Definition:</b> jacobi.h:23</div></div>
<div class="ttc" id="alinalg_8h_html_a385f37753798c2d2df487604b8e02533"><div class="ttname"><a href="linalg_8h.html#a385f37753798c2d2df487604b8e02533">svdcomp</a></div><div class="ttdeci">void svdcomp(float *a, int m, int n, float *w, float *v, float *rv1)</div><div class="ttdef"><b>Definition:</b> linalg.h:169</div></div>
<div class="ttc" id="alinalg_8h_html_a22dfe70250fc26a63604ac2dd89a228e"><div class="ttname"><a href="linalg_8h.html#a22dfe70250fc26a63604ac2dd89a228e">moore_penrose_pinv</a></div><div class="ttdeci">gsl_matrix * moore_penrose_pinv(gsl_matrix *A, const double rcond)</div><div class="ttdef"><b>Definition:</b> linalg.h:28</div></div>
<div class="ttc" id="aparser_8tab_8cc_html_af07d89f5ceaea0c7c8252cc41fd75f37"><div class="ttname"><a href="parser_8tab_8cc.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a></div><div class="ttdeci">void free(void *)</div></div>
<div class="ttc" id="anotes_8txt_html_a16ed35ac1739dfaead255294b74ba947"><div class="ttname"><a href="notes_8txt.html#a16ed35ac1739dfaead255294b74ba947">m</a></div><div class="ttdeci">I_rp2 m</div><div class="ttdef"><b>Definition:</b> notes.txt:10</div></div>
<div class="ttc" id="anotes_8txt_html_aeea9f7a762f57bfe5d9ce71f806a8c2c"><div class="ttname"><a href="notes_8txt.html#aeea9f7a762f57bfe5d9ce71f806a8c2c">n</a></div><div class="ttdeci">symbolic n</div><div class="ttdef"><b>Definition:</b> notes.txt:11</div></div>
<div class="ttc" id="alinalg_8h_html_ad9f47c2f8a96ff6b85827372bb85b3f3"><div class="ttname"><a href="linalg_8h.html#ad9f47c2f8a96ff6b85827372bb85b3f3">mp_pinv</a></div><div class="ttdeci">float * mp_pinv(const float *a, float *a_inv, int N)</div><div class="ttdef"><b>Definition:</b> linalg.h:111</div></div>
<div class="ttc" id="adebug_8txt_html_a02aba353117f867e67b23634a26c485d"><div class="ttname"><a href="debug_8txt.html#a02aba353117f867e67b23634a26c485d">N</a></div><div class="ttdeci">Bad N</div><div class="ttdef"><b>Definition:</b> debug.txt:2</div></div>
<div class="ttc" id="aeuler__step__3d__ff__tile__cu_8h_html_af7325b366c4aecba2c4331767c0c3fe7"><div class="ttname"><a href="euler__step__3d__ff__tile__cu_8h.html#af7325b366c4aecba2c4331767c0c3fe7">u</a></div><div class="ttdeci">#define u(c, z, y, x)</div><div class="ttdef"><b>Definition:</b> euler_step_3d_ff_tile_cu.h:38</div></div>
<div class="ttc" id="acp__als__3d__coo_8h_html_a91c2874585e2db61acaa001032b19acf"><div class="ttname"><a href="cp__als__3d__coo_8h.html#a91c2874585e2db61acaa001032b19acf">V</a></div><div class="ttdeci">#define V(r, q)</div><div class="ttdef"><b>Definition:</b> cp_als_3d_coo.h:27</div></div>
<div class="ttc" id="adebug_8txt_html_a747fe083c247e80cbbb6dae440f8d19e"><div class="ttname"><a href="debug_8txt.html#a747fe083c247e80cbbb6dae440f8d19e">y</a></div><div class="ttdeci">lap y</div><div class="ttdef"><b>Definition:</b> debug.txt:50</div></div>
<div class="ttc" id="alinalg_8h_html_ac39d9cef6a5e030ba8d9e11121054268"><div class="ttname"><a href="linalg_8h.html#ac39d9cef6a5e030ba8d9e11121054268">max</a></div><div class="ttdeci">#define max(x, y)</div><div class="ttdef"><b>Definition:</b> linalg.h:9</div></div>
<div class="ttc" id="agen-fib_8c_html_a2ff96143e367757f66180c3a774edd2b"><div class="ttname"><a href="gen-fib_8c.html#a2ff96143e367757f66180c3a774edd2b">f</a></div><div class="ttdeci">mpz_t * f</div><div class="ttdef"><b>Definition:</b> gen-fib.c:34</div></div>
<div class="ttc" id="aeuler__step__3d__ff__tile__cu_8h_html_ae6a3815bef35dc314aff7ebee7708985"><div class="ttname"><a href="euler__step__3d__ff__tile__cu_8h.html#ae6a3815bef35dc314aff7ebee7708985">U</a></div><div class="ttdeci">#define U(c, z, y, x)</div><div class="ttdef"><b>Definition:</b> euler_step_3d_ff_tile_cu.h:35</div></div>
<div class="ttc" id="aconjgrad__dia_8h_html_afaca147747baba296a390629014973c8"><div class="ttname"><a href="conjgrad__dia_8h.html#afaca147747baba296a390629014973c8">A</a></div><div class="ttdeci">#define A(d, i)</div><div class="ttdef"><b>Definition:</b> conjgrad_dia.h:23</div></div>
<div class="ttc" id="anotes_8txt_html_a02a960be9bf275f3b3989715a000b399"><div class="ttname"><a href="notes_8txt.html#a02a960be9bf275f3b3989715a000b399">i</a></div><div class="ttdeci">I_rp i</div><div class="ttdef"><b>Definition:</b> notes.txt:5</div></div>
<div class="ttc" id="ataco__csr__err_8txt_html_acc395ff02b0516689a2d93451c959c0e"><div class="ttname"><a href="taco__csr__err_8txt.html#acc395ff02b0516689a2d93451c959c0e">c</a></div><div class="ttdeci">tmp taco_tmp_WDmZkN qyix7mt8kaz9 c</div><div class="ttdef"><b>Definition:</b> taco_csr_err.txt:2</div></div>
<div class="ttc" id="a_matrix_i_o_8hpp_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="_matrix_i_o_8hpp.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> MatrixIO.hpp:20</div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
